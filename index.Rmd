---
title: "Netflix History"
author: "Patrick Meyer"
date: "7 2 2021"
output: ioslides_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## R Markdown

This is an R Markdown presentation. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document.

## Slide with Bullets

- Bullet 1
- Bullet 2
- Bullet 3

## Slide with R Output

```{r cars, echo = TRUE}

library(stringr)
library(aweek)
library(plotly)
#Import data
netflix = read.csv("NetflixViewingHistory.csv", sep = ";")
#Filter out movies (movies don't have the ':')
netflix = subset(x = netflix, subset = grepl(x = netflix$Title, pattern = ":"))
#Add zeros because stupid excel screwed up the dates
netflix$Date = as.character(netflix$Date)
netflix$Date = sapply(netflix$Date, FUN = 
                        function(x){if(nchar(x) < 6){x = paste("0", x, sep = "")}
                                      else{x = x}})

#Break up the Date-Column in separate columns
netflix$days = substr(netflix$Date, start = 1, stop = 2)
netflix$months = substr(netflix$Date, start = 3, stop = 4)
netflix$years = paste("20", substr(netflix$Date, start = 5, stop = 6), sep = "")
netflix$Date = as.Date(paste(netflix$years, "-", netflix$months, "-", netflix$days, sep = ""))
netflix$week = date2week(netflix$Date)
netflix$week = substr(netflix$week, start = 7, stop = 8)
netflix$weekYear = paste(netflix$years, netflix$week, sep = "-")
netflix$show = str_extract(string = netflix$Title, pattern = "[^:]+")

netflix = netflix[order(netflix$Date),]
length(table(netflix$weekYear))

netflix$weeklyViews = 1

#netflix$weeklyViews = numeric(nrow(netflix))
#for (i in 1:nrow(netflix)) {
#  netflix$weeklyViews[i] = sum(netflix$week == netflix$week[i] & netflix$years == netflix$years[i])
#}


```

# Slide with Plot


```{r pressure, warning=FALSE}
p = plot_ly(data = netflix, x = ~weekYear, y = ~weeklyViews, type = "bar", orientation = "v", color = ~years)
p = p %>% layout(xaxis = list(
                  title = "Week",
                  tickvals = netflix$weekYear,
                  ticktext = substr(netflix$weekYear, start = 6, stop = 7),
                  tickmode = "array"
                  ))
p
```

